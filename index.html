<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>달서디지털체험센터 체험부스 방명록</title>
  <style>
    :root { --radius: 16px; }
    body{font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;margin:0;background:#f6f7fb;color:#111}
    .wrap{max-width:560px;margin:0 auto;padding:24px}
    .card{background:#fff;border-radius:var(--radius);box-shadow:0 8px 24px rgba(0,0,0,.06);padding:24px}
    h1{font-size:20px;margin:0 0 4px}
    .subtitle{color:#666;margin:0 0 16px;font-size:14px}
    .field{margin:16px 0}
    .label{display:block;font-weight:600;margin-bottom:8px}
    .button {width:100%;border-radius:12px;border:1px solid #d7d9e0;padding:14px 12px;font-size:16px;background:#111;color:#fff;cursor:pointer;border:none}
    .button[disabled]{opacity:.6;cursor:not-allowed}
    .seg{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
    .seg2{grid-template-columns:repeat(2,1fr)}
    .seg5{grid-template-columns:repeat(5,1fr)}
    .chip{border:1px solid #d7d9e0;border-radius:999px;padding:10px 12px;background:#fff;text-align:center;cursor:pointer;user-select:none}
    .chip.selected{background:#111;color:#fff;border-color:#111}
    .note{font-size:12px;color:#666;margin-top:12px}
    .footer{margin-top:20px;font-size:12px;color:#999;text-align:center}
    .success{background:#e8f7ec;color:#137a31;border:1px solid #bde3c7;padding:12px;border-radius:12px;margin-top:12px;display:none}
    .error{background:#fdeaea;color:#b42318;border:1px solid #f5c2c0;padding:12px;border-radius:12px;margin-top:12px;display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>달서디지털체험센터 체험부스 방명록</h1>
      <p class="subtitle">방문객 현황 집계를 위해 거주지역과 참여인원을 선택해 주세요.</p>

      <form id="guestbookForm">
        <div class="field">
          <span class="label">거주지역</span>
          <div id="regions" class="seg seg2" role="radiogroup" aria-label="거주지역"></div>
        </div>

        <div class="field">
          <span class="label">참여인원 (1~10명)</span>
          <div id="counts" class="seg seg5" role="radiogroup" aria-label="참여인원"></div>
        </div>

        <button type="submit" id="submitBtn" class="button">등록</button>
        <div id="ok" class="success">등록되었습니다. 참여해주셔서 감사합니다!</div>
        <div id="fail" class="error">전송에 문제가 발생했습니다. 다시 시도해 주세요.</div>
        <p class="note">입력하신 정보는 통계 집계 목적에만 사용됩니다. (개인식별정보 수집 없음)</p>
      </form>
    </div>
    <p class="footer">© 달서디지털체험센터</p>
  </div>

  <script>
    // == 설정: 아래에 Google Apps Script Web App URL을 붙여넣으세요 ==
    const GAS_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbwl2ZWa7rIMdgWflgHLT-vP0yBcVBbyGNfOcAhnvMHDR7FQQp6I7b3OcI_dauF-uRnomA/exec";

    // 거주지역 버튼
    const regionOptions = ["달서구","달서구외"];
    const regionsEl = document.getElementById('regions');
    let selectedRegion = null;
    regionOptions.forEach(label=>{
      const b = document.createElement('button');
      b.type = 'button';
      b.className = 'chip';
      b.textContent = label;
      b.setAttribute('role','radio');
      b.setAttribute('aria-checked','false');
      b.addEventListener('click',()=>{
        selectedRegion = label;
        regionsEl.querySelectorAll('.chip').forEach(c=>{c.classList.remove('selected');c.setAttribute('aria-checked','false')});
        b.classList.add('selected');
        b.setAttribute('aria-checked','true');
      });
      regionsEl.appendChild(b);
    });

    // 참여인원 버튼 (1~10)
    const countsEl = document.getElementById('counts');
    let selectedCount = null;
    for (let i=1;i<=10;i++){
      const b = document.createElement('button');
      b.type = 'button';
      b.className = 'chip';
      b.textContent = String(i);
      b.setAttribute('role','radio');
      b.setAttribute('aria-checked','false');
      b.addEventListener('click',()=>{
        selectedCount = i;
        countsEl.querySelectorAll('.chip').forEach(c=>{c.classList.remove('selected');c.setAttribute('aria-checked','false')});
        b.classList.add('selected');
        b.setAttribute('aria-checked','true');
      });
      countsEl.appendChild(b);
    }

    // 제출
    const form = document.getElementById('guestbookForm');
    const submitBtn = document.getElementById('submitBtn');
    const ok = document.getElementById('ok');
    const fail = document.getElementById('fail');

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      ok.style.display = 'none';
      fail.style.display = 'none';

      if(!selectedRegion){ alert('거주지역을 선택해 주세요.'); return; }
      if(!selectedCount){ alert('참여인원을 선택해 주세요.'); return; }

      submitBtn.disabled = true;
      submitBtn.textContent = '전송 중…';

      try{
        const payload = { region: selectedRegion, count: selectedCount };

        await fetch(GAS_WEBAPP_URL, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        ok.style.display = 'block';
        form.reset();
        document.querySelectorAll('.chip').forEach(c=>c.classList.remove('selected'));
        selectedRegion = null;
        selectedCount = null;
      } catch(err){
        console.error(err);
        fail.style.display = 'block';
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = '등록';
      }
    });
  </script>
</body>
</html>
